'use strict';function cov_1nrdiiy75w(){var path="C:\\Users\\Ramses Coraspe\\Documents\\GitHub\\RESTful-APIs-Nodejs\\server\\middlewares\\duplicated.js";var hash="53a77cfec79a0a64605f73098a7e3ace4e518f53";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"C:\\Users\\Ramses Coraspe\\Documents\\GitHub\\RESTful-APIs-Nodejs\\server\\middlewares\\duplicated.js",statementMap:{"0":{start:{line:2,column:13},end:{line:2,column:30}},"1":{start:{line:3,column:13},end:{line:3,column:47}},"2":{start:{line:4,column:23},end:{line:4,column:55}},"3":{start:{line:5,column:13},end:{line:5,column:40}},"4":{start:{line:9,column:0},end:{line:90,column:2}},"5":{start:{line:11,column:4},end:{line:89,column:11}},"6":{start:{line:12,column:8},end:{line:88,column:13}},"7":{start:{line:13,column:12},end:{line:13,column:98}},"8":{start:{line:16,column:26},end:{line:16,column:28}},"9":{start:{line:17,column:16},end:{line:19,column:19}},"10":{start:{line:18,column:20},end:{line:18,column:41}},"11":{start:{line:21,column:16},end:{line:87,column:17}},"12":{start:{line:23,column:35},end:{line:27,column:25}},"13":{start:{line:23,column:77},end:{line:27,column:23}},"14":{start:{line:29,column:22},end:{line:82,column:25}},"15":{start:{line:33,column:34},end:{line:81,column:35}},"16":{start:{line:34,column:38},end:{line:34,column:81}},"17":{start:{line:37,column:38},end:{line:80,column:39}},"18":{start:{line:38,column:42},end:{line:38,column:49}},"19":{start:{line:41,column:42},end:{line:79,column:45}},"20":{start:{line:44,column:65},end:{line:44,column:83}},"21":{start:{line:45,column:58},end:{line:45,column:82}},"22":{start:{line:47,column:48},end:{line:74,column:49}},"23":{start:{line:49,column:52},end:{line:49,column:59}},"24":{start:{line:51,column:53},end:{line:74,column:49}},"25":{start:{line:53,column:65},end:{line:53,column:67}},"26":{start:{line:54,column:52},end:{line:54,column:80}},"27":{start:{line:55,column:52},end:{line:55,column:79}},"28":{start:{line:56,column:52},end:{line:56,column:100}},"29":{start:{line:58,column:52},end:{line:58,column:109}},"30":{start:{line:59,column:52},end:{line:59,column:92}},"31":{start:{line:61,column:52},end:{line:61,column:88}},"32":{start:{line:65,column:65},end:{line:65,column:67}},"33":{start:{line:66,column:52},end:{line:66,column:80}},"34":{start:{line:67,column:52},end:{line:67,column:79}},"35":{start:{line:68,column:52},end:{line:68,column:103}},"36":{start:{line:70,column:52},end:{line:70,column:109}},"37":{start:{line:71,column:52},end:{line:71,column:92}},"38":{start:{line:73,column:52},end:{line:73,column:88}},"39":{start:{line:78,column:48},end:{line:78,column:55}},"40":{start:{line:86,column:20},end:{line:86,column:27}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:9,column:20},end:{line:9,column:21}},loc:{start:{line:9,column:44},end:{line:90,column:1}},line:9},"1":{name:"(anonymous_1)",decl:{start:{line:11,column:51},end:{line:11,column:52}},loc:{start:{line:11,column:77},end:{line:89,column:9}},line:11},"2":{name:"(anonymous_2)",decl:{start:{line:17,column:55},end:{line:17,column:56}},loc:{start:{line:17,column:66},end:{line:19,column:17}},line:17},"3":{name:"(anonymous_3)",decl:{start:{line:23,column:70},end:{line:23,column:71}},loc:{start:{line:23,column:75},end:{line:27,column:24}},line:23},"4":{name:"(anonymous_4)",decl:{start:{line:32,column:28},end:{line:32,column:29}},loc:{start:{line:32,column:53},end:{line:82,column:23}},line:32}},branchMap:{"0":{loc:{start:{line:12,column:8},end:{line:88,column:13}},type:"if",locations:[{start:{line:12,column:8},end:{line:88,column:13}},{start:{line:12,column:8},end:{line:88,column:13}}],line:12},"1":{loc:{start:{line:21,column:16},end:{line:87,column:17}},type:"if",locations:[{start:{line:21,column:16},end:{line:87,column:17}},{start:{line:21,column:16},end:{line:87,column:17}}],line:21},"2":{loc:{start:{line:33,column:34},end:{line:81,column:35}},type:"if",locations:[{start:{line:33,column:34},end:{line:81,column:35}},{start:{line:33,column:34},end:{line:81,column:35}}],line:33},"3":{loc:{start:{line:37,column:38},end:{line:80,column:39}},type:"if",locations:[{start:{line:37,column:38},end:{line:80,column:39}},{start:{line:37,column:38},end:{line:80,column:39}}],line:37},"4":{loc:{start:{line:41,column:42},end:{line:79,column:45}},type:"if",locations:[{start:{line:41,column:42},end:{line:79,column:45}},{start:{line:41,column:42},end:{line:79,column:45}}],line:41},"5":{loc:{start:{line:47,column:48},end:{line:74,column:49}},type:"if",locations:[{start:{line:47,column:48},end:{line:74,column:49}},{start:{line:47,column:48},end:{line:74,column:49}}],line:47},"6":{loc:{start:{line:51,column:53},end:{line:74,column:49}},type:"if",locations:[{start:{line:51,column:53},end:{line:74,column:49}},{start:{line:51,column:53},end:{line:74,column:49}}],line:51}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"53a77cfec79a0a64605f73098a7e3ace4e518f53"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];cov_1nrdiiy75w=function(){return actualCoverage;};return actualCoverage;}cov_1nrdiiy75w();var moment=(cov_1nrdiiy75w().s[0]++,require('moment'));var config=(cov_1nrdiiy75w().s[1]++,require('../configuration/config'));var OrdersController=(cov_1nrdiiy75w().s[2]++,require('../controllers/orders'));var Orders=(cov_1nrdiiy75w().s[3]++,require('../models/orders'));cov_1nrdiiy75w().s[4]++;exports.duplicated=function(req,res,next){cov_1nrdiiy75w().f[0]++;cov_1nrdiiy75w().s[5]++;OrdersController.getAccountData(req.params.id,function(callbackPostData){cov_1nrdiiy75w().f[1]++;cov_1nrdiiy75w().s[6]++;if(callbackPostData.value===null){cov_1nrdiiy75w().b[0][0]++;cov_1nrdiiy75w().s[7]++;return res.status(callbackPostData.httpcode).send({message:callbackPostData.message});}else{cov_1nrdiiy75w().b[0][1]++;var ids=(cov_1nrdiiy75w().s[8]++,[]);cov_1nrdiiy75w().s[9]++;callbackPostData.value.issuers.forEach(element=>{cov_1nrdiiy75w().f[2]++;cov_1nrdiiy75w().s[10]++;ids.push(element._id);});cov_1nrdiiy75w().s[11]++;if(ids.length>0){cov_1nrdiiy75w().b[1][0]++;var issuers=(cov_1nrdiiy75w().s[12]++,callbackPostData.value.issuers.map(u=>{cov_1nrdiiy75w().f[3]++;cov_1nrdiiy75w().s[13]++;return{issuer_name:u.issuer_name,total_shares:u.total_shares,share_price:u.share_price};}));cov_1nrdiiy75w().s[14]++;Orders.find({"_id":{$in:ids},"issuer_name":req.body.issuer_name}).select('-_id timestamp').sort('-timestamp').exec(function(err,ordersfound){cov_1nrdiiy75w().f[4]++;cov_1nrdiiy75w().s[15]++;if(err){cov_1nrdiiy75w().b[2][0]++;cov_1nrdiiy75w().s[16]++;return res.status(500).send({message:err});}else{cov_1nrdiiy75w().b[2][1]++;cov_1nrdiiy75w().s[17]++;if(!ordersfound){cov_1nrdiiy75w().b[3][0]++;cov_1nrdiiy75w().s[18]++;next();}else{cov_1nrdiiy75w().b[3][1]++;cov_1nrdiiy75w().s[19]++;if(ordersfound.length>0){cov_1nrdiiy75w().b[4][0]++;var tmscurrent=(cov_1nrdiiy75w().s[20]++,req.body.timestamp);var tms=(cov_1nrdiiy75w().s[21]++,ordersfound[0].timestamp);cov_1nrdiiy75w().s[22]++;if(tmscurrent-tms>=config.api.interval){cov_1nrdiiy75w().b[5][0]++;cov_1nrdiiy75w().s[23]++;next();}else{cov_1nrdiiy75w().b[5][1]++;cov_1nrdiiy75w().s[24]++;if(tms>tmscurrent){cov_1nrdiiy75w().b[6][0]++;var result=(cov_1nrdiiy75w().s[25]++,{});cov_1nrdiiy75w().s[26]++;result.current_balance={};cov_1nrdiiy75w().s[27]++;result.business_error=[];cov_1nrdiiy75w().s[28]++;result.business_error.push("Invalid Operation");cov_1nrdiiy75w().s[29]++;result.current_balance.cash=callbackPostData.value.cash;cov_1nrdiiy75w().s[30]++;result.current_balance.issuers=issuers;cov_1nrdiiy75w().s[31]++;return res.status(404).send(result);}else{cov_1nrdiiy75w().b[6][1]++;var result=(cov_1nrdiiy75w().s[32]++,{});cov_1nrdiiy75w().s[33]++;result.current_balance={};cov_1nrdiiy75w().s[34]++;result.business_error=[];cov_1nrdiiy75w().s[35]++;result.business_error.push("Duplicated Operation");cov_1nrdiiy75w().s[36]++;result.current_balance.cash=callbackPostData.value.cash;cov_1nrdiiy75w().s[37]++;result.current_balance.issuers=issuers;cov_1nrdiiy75w().s[38]++;return res.status(202).send(result);}}}else{cov_1nrdiiy75w().b[4][1]++;cov_1nrdiiy75w().s[39]++;next();}}}});}else{cov_1nrdiiy75w().b[1][1]++;cov_1nrdiiy75w().s[40]++;next();}}});};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImR1cGxpY2F0ZWQuanMiXSwibmFtZXMiOlsibW9tZW50IiwicmVxdWlyZSIsImNvbmZpZyIsIk9yZGVyc0NvbnRyb2xsZXIiLCJPcmRlcnMiLCJleHBvcnRzIiwiZHVwbGljYXRlZCIsInJlcSIsInJlcyIsIm5leHQiLCJnZXRBY2NvdW50RGF0YSIsInBhcmFtcyIsImlkIiwiY2FsbGJhY2tQb3N0RGF0YSIsInZhbHVlIiwic3RhdHVzIiwiaHR0cGNvZGUiLCJzZW5kIiwibWVzc2FnZSIsImlkcyIsImlzc3VlcnMiLCJmb3JFYWNoIiwiZWxlbWVudCIsInB1c2giLCJfaWQiLCJsZW5ndGgiLCJtYXAiLCJ1IiwiaXNzdWVyX25hbWUiLCJ0b3RhbF9zaGFyZXMiLCJzaGFyZV9wcmljZSIsImZpbmQiLCIkaW4iLCJib2R5Iiwic2VsZWN0Iiwic29ydCIsImV4ZWMiLCJlcnIiLCJvcmRlcnNmb3VuZCIsInRtc2N1cnJlbnQiLCJ0aW1lc3RhbXAiLCJ0bXMiLCJhcGkiLCJpbnRlcnZhbCIsInJlc3VsdCIsImN1cnJlbnRfYmFsYW5jZSIsImJ1c2luZXNzX2Vycm9yIiwiY2FzaCJdLCJtYXBwaW5ncyI6IkFBQUEsYSwyOEtBQ0EsR0FBSUEsQ0FBQUEsTUFBTSwwQkFBR0MsT0FBTyxDQUFDLFFBQUQsQ0FBVixDQUFWLENBQ0EsR0FBSUMsQ0FBQUEsTUFBTSwwQkFBR0QsT0FBTyxDQUFDLHlCQUFELENBQVYsQ0FBVixDQUNBLEdBQUlFLENBQUFBLGdCQUFnQiwwQkFBR0YsT0FBTyxDQUFDLHVCQUFELENBQVYsQ0FBcEIsQ0FDQSxHQUFJRyxDQUFBQSxNQUFNLDBCQUFHSCxPQUFPLENBQUMsa0JBQUQsQ0FBVixDQUFWLEMsd0JBSUFJLE9BQU8sQ0FBQ0MsVUFBUixDQUFvQixTQUFTQyxHQUFULENBQWNDLEdBQWQsQ0FBbUJDLElBQW5CLENBQXdCLGlEQUV4Q04sZ0JBQWdCLENBQUNPLGNBQWpCLENBQWdDSCxHQUFHLENBQUNJLE1BQUosQ0FBV0MsRUFBM0MsQ0FBK0Ms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QUFJQSxDQUFBQSxNQUFNLDJCQUFHLEVBQUgsQ0FBVixDQUZBLHlCQUdBQSxNQUFNLENBQUNDLGVBQVAsQ0FBeUIsRUFBekIsQ0FIQSx5QkFJQUQsTUFBTSxDQUFDRSxjQUFQLENBQXdCLEVBQXhCLENBSkEseUJBS0FGLE1BQU0sQ0FBQ0UsY0FBUCxDQUFzQnZCLElBQXRCLENBQTJCLHNCQUEzQixFQUxBLHlCQU9BcUIsTUFBTSxDQUFDQyxlQUFQLENBQXVCRSxJQUF2QixDQUE4QmxDLGdCQUFnQixDQUFDQyxLQUFqQixDQUF1QmlDLElBQXJELENBUEEseUJBUUFILE1BQU0sQ0FBQ0MsZUFBUCxDQUF1QnpCLE9BQXZCLENBQWlDQSxPQUFqQyxDQVJBLHlCQVVBLE1BQU9aLENBQUFBLEdBQUcsQ0FBQ08sTUFBSixDQUFXLEdBQVgsRUFBZ0JFLElBQWhCLENBQXFCMkIsTUFBckIsQ0FBUCxDQUNILEVBQ0osQ0FsQ0gsSUFtQ00scURBRUFuQyxJQUFJLEdBQ1AsQ0FDTixDQUNKLENBQ1osQ0FyREQsRUF1REwsQ0EvREQsSUFnRUkscURBQ0FBLElBQUksR0FDUCxDQUNKLENBQ0osQ0E5RUwsRUErRUgsQ0FqRkQiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCdcclxudmFyIG1vbWVudCA9IHJlcXVpcmUoJ21vbWVudCcpO1xyXG52YXIgY29uZmlnID0gcmVxdWlyZSgnLi4vY29uZmlndXJhdGlvbi9jb25maWcnKTtcclxudmFyIE9yZGVyc0NvbnRyb2xsZXIgPSByZXF1aXJlKCcuLi9jb250cm9sbGVycy9vcmRlcnMnKTtcclxudmFyIE9yZGVycyA9IHJlcXVpcmUoJy4uL21vZGVscy9vcmRlcnMnKTtcclxuXHJcblxyXG5cclxuZXhwb3J0cy5kdXBsaWNhdGVkPSBmdW5jdGlvbihyZXEsIHJlcywgbmV4dCl7XHJcblxyXG4gICAgT3JkZXJzQ29udHJvbGxlci5nZXRBY2NvdW50RGF0YShyZXEucGFyYW1zLmlkLCBmdW5jdGlvbihjYWxsYmFja1Bvc3REYXRhKXtcclxuICAgICAgICBpZihjYWxsYmFja1Bvc3REYXRhLnZhbHVlPT09bnVsbCl7IFxyXG4gICAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyhjYWxsYmFja1Bvc3REYXRhLmh0dHBjb2RlKS5zZW5kKHttZXNzYWdlOmNhbGxiYWNrUG9zdERhdGEubWVzc2FnZX0pOyBcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZXsgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICB2YXIgaWRzID0gW11cclxuICAgICAgICAgICAgICAgIGNhbGxiYWNrUG9zdERhdGEudmFsdWUuaXNzdWVycy5mb3JFYWNoKGVsZW1lbnQgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGlkcy5wdXNoKGVsZW1lbnQuX2lkKVxyXG4gICAgICAgICAgICAgICAgfSk7ICAgICBcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgaWYoaWRzLmxlbmd0aCA+IDApe1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB2YXIgaXNzdWVycyAgPSBjYWxsYmFja1Bvc3REYXRhLnZhbHVlLmlzc3VlcnMubWFwKHUgPT4geyByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpc3N1ZXJfbmFtZTogdS5pc3N1ZXJfbmFtZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxfc2hhcmVzOiB1LnRvdGFsX3NoYXJlcyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2hhcmVfcHJpY2U6IHUuc2hhcmVfcHJpY2UgICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgICAgfX0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgIE9yZGVycy5maW5kKCB7IFwiX2lkXCIgOiAgeyAkaW4gOiBpZHMgfSwgXCJpc3N1ZXJfbmFtZVwiIDogIHJlcS5ib2R5Lmlzc3Vlcl9uYW1lIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAuc2VsZWN0KCctX2lkIHRpbWVzdGFtcCcpXHJcbiAgICAgICAgICAgICAgICAgICAgICAuc29ydCgnLXRpbWVzdGFtcCcpICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICAgIC5leGVjKGZ1bmN0aW9uKGVycixvcmRlcnNmb3VuZCl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihlcnIpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDUwMCkuc2VuZCh7bWVzc2FnZTplcnJ9KTsgICAgICAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZighb3JkZXJzZm91bmQpeyBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV4dCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNleyBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYob3JkZXJzZm91bmQubGVuZ3RoID4gMClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRtc2N1cnJlbnQgPSByZXEuYm9keS50aW1lc3RhbXBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRtcyA9IG9yZGVyc2ZvdW5kWzBdLnRpbWVzdGFtcFxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoKHRtc2N1cnJlbnQtdG1zKSA+PSBjb25maWcuYXBpLmludGVydmFsICkge1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5leHQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmKHRtcyA+IHRtc2N1cnJlbnQpe1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXN1bHQgPSB7fTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC5jdXJyZW50X2JhbGFuY2UgPSB7fTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC5idXNpbmVzc19lcnJvciA9IFtdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0LmJ1c2luZXNzX2Vycm9yLnB1c2goXCJJbnZhbGlkIE9wZXJhdGlvblwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0LmN1cnJlbnRfYmFsYW5jZS5jYXNoID0gY2FsbGJhY2tQb3N0RGF0YS52YWx1ZS5jYXNoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQuY3VycmVudF9iYWxhbmNlLmlzc3VlcnMgPSBpc3N1ZXJzXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLnNlbmQocmVzdWx0KTsgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gICBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0ge307XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQuY3VycmVudF9iYWxhbmNlID0ge307XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQuYnVzaW5lc3NfZXJyb3IgPSBbXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC5idXNpbmVzc19lcnJvci5wdXNoKFwiRHVwbGljYXRlZCBPcGVyYXRpb25cIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC5jdXJyZW50X2JhbGFuY2UuY2FzaCA9IGNhbGxiYWNrUG9zdERhdGEudmFsdWUuY2FzaFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0LmN1cnJlbnRfYmFsYW5jZS5pc3N1ZXJzID0gaXNzdWVyc1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAyKS5zZW5kKHJlc3VsdCk7ICAgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZXtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5leHQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9ICAgIFxyXG4gICAgICAgICAgICAgICAgICAgICAgfSk7IFxyXG5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2V7XHJcbiAgICAgICAgICAgICAgICAgICAgbmV4dCgpO1xyXG4gICAgICAgICAgICAgICAgfSAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7IFxyXG59O1xyXG4iXX0=